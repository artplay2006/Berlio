@model BerlioWeb.Models.User
@inject IConfiguration configuration

@{
    ViewData["Title"] = "Вход";
    var siteKey = "6LfqoPIqAAAAAMf0iq6U0oqn57YhdIjJwnWazIeU";
}

@section Scripts {
    <script src="https://www.google.com/recaptcha/api.js"></script>
    <script>
        function onSubmit(token) {
          document.getElementById("myForm").submit();
        }
        // document.getElementById("myForm").addEventListener("submit", function (e) {
        //     e.preventDefault(); // Предотвращаем стандартную отправку формы

        //     grecaptcha.ready(function () {
        //         grecaptcha.execute('@siteKey', { action: 'submit' }).then(function (token) {
        //             // Добавляем токен в форму
        //             document.getElementById("foo").value = token;
        //             document.getElementById("myForm").submit();
        //         });
        //     });
        // });
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(`${inputId}-icon`);

            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        }
    </script>
}
<div class="login-container">
    <div class="back-button">
        <a asp-area="" asp-controller="Home" asp-action="Index" style="text-decoration: none; color: white;">
            <i class="fas fa-arrow-left" style="font-size: 1.5rem;">×</i>
        </a>
    </div>
    <div class="login-form">
        <h2 class="login-title">Авторизация</h2>
        <form id="myForm" asp-action="Authorization" asp-controller="Account" method="post">
            @* <input type="hidden" id="foo" name="foo" /> *@
            <div class="mb-3">
                <label for="login" class="form-label">Логин</label>
                <input type="text" class="form-control" id="login" name="Login" placeholder="Введите логин">
                @* @Html.ValidationMessageFor(model => model.Login, "Поле логина не заполнено", new { @class = "text-danger" }) *@
                @if (ViewData["LoginError"] != null)
                {
                    <div class="text-danger">
                        @ViewData["LoginError"]
                    </div>
                }
            </div>
            <div class="mb-3 password-field">
                <label for="password" class="form-label">Пароль</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="password" name="Pasword" placeholder="Введите пароль">
                    <button style="margin-bottom: 15px;" type="button" class="btn btn-outline-secondary" onclick="togglePasswordVisibility('password')">
                        <i class="fas fa-eye-slash" id="password-icon"></i>
                    </button>
                </div>
                @* @Html.ValidationMessageFor(model => model.Pasword, "Поле пароля не заполнено", new { @class = "text-danger" }) *@
                @if (ViewData["PasswordError"] != null)
                {
                    <div class="text-danger">
                        @ViewData["PasswordError"]
                    </div>
                }
            </div>
            <!-- Добавление reCAPTCHA -->
            @* <div class="mb-3">
                <div class="g-recaptcha" data-sitekey="6Le4M-YqAAAAACmsDAGX-23Qou0jchr7tD23YcCP"></div>
                @if (ViewData["ReCaptchaError"] != null)
                {
                    <div class="text-danger">
                        @ViewData["ReCaptchaError"]
                    </div>
                }
            </div> *@
            <button type="submit"
                class="btn btn-primary login-button g-recaptcha"
                    data-sitekey="@siteKey"
                    data-callback='onSubmit'
                    data-action='submit'>
                Продолжить
            </button>
            <div class="login-links">
                <a asp-area="" asp-controller="Account" asp-action="Registration" class="register-link">Регистрация</a>
                <a href="#" class="forgot-password-link">Забыл пароль?</a>
            </div>
        </form>
    </div>
</div>

